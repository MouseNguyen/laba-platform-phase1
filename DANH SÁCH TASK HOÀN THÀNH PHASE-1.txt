# ğŸ¯ DANH SÃCH TASK HOÃ€N THÃ€NH PHASE 0-1 (CHO CLAUDE 4.5)

DÆ°á»›i Ä‘Ã¢y lÃ  **danh sÃ¡ch task chi tiáº¿t** theo Ä‘Ãºng káº¿ hoáº¡ch 5 ngÃ y. Má»—i task cÃ³ prompt Ä‘á»ƒ báº¡n copy-paste vÃ o Claude.

---

## **ğŸ“… DAY 1: PHASE 0 - TÃ€I LIá»†U & SKELETON**

### **Task 1.1: Táº¡o `/docs/architecture-overview.md`**
```prompt
Viáº¿t file tÃ i liá»‡u `/docs/architecture-overview.md` cho dá»± Ã¡n Laba Platform vá»›i ná»™i dung:

**Má»¥c tiÃªu**: MÃ´ táº£ tá»•ng quan kiáº¿n trÃºc há»‡ thá»‘ng, stack ká»¹ thuáº­t, luá»“ng dá»¯ liá»‡u vÃ  quy Æ°á»›c phÃ¡t triá»ƒn.

**Ná»™i dung cáº§n cÃ³**:
1. Táº§m nhÃ¬n: Ná»n táº£ng Ä‘a chi nhÃ¡nh (Farm, Homestay, Cafe) vá»›i booking, e-commerce, POS, CRM
2. Kiáº¿n trÃºc: Plugin-based (Core Platform + Module)
3. Tech Stack:
   - Backend: NestJS (Modular Monolith), Prisma, PostgreSQL, Redis, JWT
   - Frontend: Next.js 14 (App Router), TypeScript, Tailwind CSS
   - Monitoring: Prometheus + Grafana
   - Testing: Jest, k6, Pact
4. Luá»“ng Auth: JWT Access Token (memory) + Refresh Token (HttpOnly Cookie) + Token versioning
5. Luá»“ng Request: Frontend â†’ API Gateway (sáº½ cÃ³) â†’ NestJS Modules â†’ PostgreSQL
6. Quy Æ°á»›c Module: Má»—i module riÃªng biá»‡t (auth, users, branches, posts, booking, shop)
7. Cáº¥u trÃºc thÆ° má»¥c backend vÃ  frontend hiá»‡n táº¡i

**Tham kháº£o**: File `LabaPlatform_README_TongQuan_DuAn.docx` vÃ  `TÃ“M Táº®T Dá»° ÃN LABA PLATFORM` Ä‘Ã£ cung cáº¥p.

**Äáº§u ra**: Markdown file vá»›i tiÃªu Ä‘á» rÃµ rÃ ng, code block vÃ­ dá»¥ config náº¿u cáº§n.
```

### **Task 1.2: Táº¡o `/docs/api-conventions.md`**
```prompt
Viáº¿t file `/docs/api-conventions.md` quy Ä‘á»‹nh chuáº©n API cho toÃ n dá»± Ã¡n:

**Ná»™i dung**:
1. **Response Format**:
   ```json
   {
     "statusCode": 200,
     "message": "ThÃ nh cÃ´ng",
     "data": {},
     "meta": { "page": 1, "limit": 10, "total": 100 }
   }
   ```
2. **Error Codes**: 
   - 400: Bad Request (validation error)
   - 401: Unauthorized
   - 403: Forbidden (permission denied)
   - 404: Not Found
   - 409: Conflict (duplicate, concurrency)
   - 422: Unprocessable Entity
   - 500: Internal Server Error
3. **Pagination**: `page`, `limit`, `total`, `totalPages`
4. **Filter Pattern**: `GET /resource?field=value&sort=field:asc`
5. **Timestamp**: LuÃ´n dÃ¹ng ISO 8601, timezone Asia/Ho_Chi_Minh
6. **ID Format**: Sá»‘ nguyÃªn (Int) cho DB ID, UUID cho public reference náº¿u cáº§n
7. **Soft Delete**: KhÃ´ng dÃ¹ng `DELETE` hard delete, dÃ¹ng `PATCH` vá»›i `deletedAt`
8. **Versioning**: `/api/v1/` prefix cho táº¥t cáº£ endpoints

**Tham kháº£o**: Quy Æ°á»›c Ä‘Ã£ cÃ³ trong codebase hiá»‡n táº¡i (xem `auth` module).

**Äáº§u ra**: Markdown file vá»›i báº£ng biá»ƒu vÃ  vÃ­ dá»¥ rÃµ rÃ ng.
```

### **Task 1.3: Táº¡o ESLint & Prettier config**
```prompt
Táº¡o file cáº¥u hÃ¬nh code style cho backend:

1. **File**: `/backend/.eslintrc.js` vá»›i config NestJS standard:
   - extends: ['@nestjs/eslint-config']
   - rules: semicolon: always, single quotes, no trailing spaces
   - ignorePatterns: ['dist', 'node_modules', '*.js']

2. **File**: `/backend/.prettierrc`:
   ```json
   {
     "singleQuote": true,
     "trailingComma": "all",
     "semi": true,
     "tabWidth": 2,
     "printWidth": 100
   }
   ```

3. **Cáº­p nháº­t `package.json`** thÃªm scripts:
   ```json
   "lint": "eslint \"{src,apps,libs,test}/**/*.ts\" --fix",
   "format": "prettier --write \"src/**/*.ts\""
   ```

**Äáº§u ra**: 2 file config + script npm (chá»‰ cáº§n chá»‰ ra cáº§n thÃªm gÃ¬ vÃ o package.json).
```

### **Task 1.4: Táº¡o `/backend/README.md`**
```prompt
Viáº¿t file `/backend/README.md` hÆ°á»›ng dáº«n setup development:

**Ná»™i dung**:
1. Prerequisites: Node.js 20+, PostgreSQL 15+, Redis 7+
2. Installation: `npm install`, `npx prisma generate`
3. Database: `npx prisma migrate reset --force` (cháº¡y seed)
4. Environment: Copy `.env.example` â†’ `.env`, cháº¡y `npm run generate-secrets`
5. Running dev: `npm run start:dev` (port 3000)
6. Running tests: `npm run test:e2e`
7. API docs: Swagger táº¡i `/api/docs`
8. Monitoring: Prometheus metrics táº¡i `/metrics` (cáº§n auth)
9. Project structure: Giáº£i thÃ­ch cÃ¡c thÆ° má»¥c chÃ­nh (`src/auth`, `src/users`, v.v.)

**Tham kháº£o**: File `.env` template trong tÃ³m táº¯t dá»± Ã¡n.

**Äáº§u ra**: Markdown file vá»›i code block commands.
```

### **Task 1.5: Táº¡o module skeleton**
```prompt
Táº¡o 3 module skeleton trá»‘ng (chÆ°a logic) Ä‘á»ƒ chuáº©n bá»‹ cho Day 2-3:

1. **Module CMS**: `/backend/src/cms/cms.module.ts`
   - Import PrismaModule, export PostsService (sáº½ táº¡o sau)
   - Structure: controllers/, services/, dtos/, entities/

2. **Module Branches**: `/backend/src/branches/branches.module.ts`
   - TÆ°Æ¡ng tá»±, export BranchesService

3. **Module Users Admin**: `/backend/src/users-admin/users-admin.module.ts`
   - TÃ¡ch riÃªng khá»i auth module, chá»‰ dÃ nh cho admin operations

**Äáº§u ra**: 3 file module TypeScript vá»›i cáº¥u trÃºc NestJS chuáº©n (imports, controllers, providers).
```

### **Task 1.6: Táº¡o frontend folder structure**
```prompt
Táº¡o cáº¥u trÃºc thÆ° má»¥c frontend chuáº©n:

```
frontend/
â”œâ”€â”€ src/app/(public)/          # Website public
â”‚   â”œâ”€â”€ about/page.tsx
â”‚   â”œâ”€â”€ blog/page.tsx
â”‚   â”œâ”€â”€ blog/[slug]/page.tsx
â”‚   â””â”€â”€ contact/page.tsx
â”œâ”€â”€ src/app/(admin)/           # Admin portal
â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”œâ”€â”€ users/page.tsx
â”‚   â”œâ”€â”€ branches/page.tsx
â”‚   â””â”€â”€ posts/page.tsx
â”œâ”€â”€ src/components/ui/         # UI components chung
â”‚   â”œâ”€â”€ Button.tsx
â”‚   â”œâ”€â”€ Table.tsx
â”‚   â””â”€â”€ Badge.tsx
â”œâ”€â”€ src/lib/api/               # API clients
â”‚   â”œâ”€â”€ posts.ts
â”‚   â”œâ”€â”€ branches.ts
â”‚   â””â”€â”€ users-admin.ts
â””â”€â”€ src/types/                 # TypeScript types
    â”œâ”€â”€ post.ts
    â”œâ”€â”€ branch.ts
    â””â”€â”€ user.ts
```

**Äáº§u ra**: Tree structure + táº¡o cÃ¡c file `.gitkeep` hoáº·c file trá»‘ng cÃ³ tÃªn rÃµ rÃ ng.
```

---

## **ğŸ“… DAY 2: PHASE 1 - CMS POSTS BACKEND**

### **Task 2.1: Cáº­p nháº­t Prisma schema Post**
```prompt
Cáº­p nháº­t file `/backend/prisma/schema.prisma` thÃªm model Post:

```prisma
model Post {
  id            Int       @id @default(autoincrement())
  type          String    // PAGE, BLOG, NEWS
  slug          String    @unique
  title         String
  excerpt       String?
  content       Json      // Rich text JSON
  thumbnailUrl  String?   @map("thumbnail_url")
  authorId      Int?      @map("author_id")
  isPublished   Boolean   @default(false) @map("is_published")
  publishedAt   DateTime? @map("published_at")
  createdAt     DateTime  @default(now()) @map("created_at")
  updatedAt     DateTime  @updatedAt @map("updated_at")
  deletedAt     DateTime? @map("deleted_at")
  
  author        User?     @relation(fields: [authorId], references: [id])
  
  @@index([type])
  @@index([isPublished])
  @@map("posts")
}
```

**YÃªu cáº§u**:
- ThÃªm vÃ o schema hiá»‡n cÃ³ (giá»¯ nguyÃªn cÃ¡c model khÃ¡c)
- Cháº¡y migration: `npx prisma migrate dev --name add-posts-table`
- Cáº­p nháº­t `prisma/seed.ts` Ä‘á»ƒ seed 3-5 bÃ i viáº¿t máº«u (type: PAGE, BLOG)

**Äáº§u ra**: schema.prisma Ä‘Ã£ cáº­p nháº­t + migration file + seed code.
```

### **Task 2.2: Táº¡o DTOs cho Posts**
```prompt
Táº¡o DTOs cho module CMS trong `/backend/src/cms/dtos/`:

1. **create-post.dto.ts**:
   - Fields: type, slug, title, excerpt, content(JSON), thumbnailUrl, authorId
   - Validation: @IsString(), @IsNotEmpty(), @IsOptional(), @IsBoolean()

2. **update-post.dto.ts**:
   - Partial cá»§a create-post.dto
   - DÃ¹ng @nestjs/mapped-types

3. **query-posts.dto.ts**:
   - Fields: type?, page?, limit?, isPublished?, authorId?
   - Validation: @IsInt(), @Min(1), @IsOptional()

**Tham kháº£o**: DTOs trong `auth/dto/` (cÃ¡ch dÃ¹ng class-validator).

**Äáº§u ra**: 3 file DTO vá»›i validation Ä‘áº§y Ä‘á»§.
```

### **Task 2.3: Táº¡o PostsService**
```prompt
Táº¡o `/backend/src/cms/posts.service.ts` vá»›i cÃ¡c methods:

- `create(createPostDto, userId): Promise<Post>` 
  - Táº¡o post má»›i, set authorId tá»« user hiá»‡n táº¡i
  - Kiá»ƒm tra slug unique (catch Prisma P2002)

- `findAll(query: QueryPostsDto): Promise<{data: Post[], meta: {page, limit, total}}>`
  - Filter theo type, isPublished, authorId
  - Pagination vá»›i prisma skip/take
  - Soft delete: chá»‰ láº¥y deletedAt IS NULL

- `findOne(slug: string): Promise<Post>`
  - Láº¥y post theo slug, throw NotFoundException náº¿u khÃ´ng tá»“n táº¡i

- `update(id: number, updatePostDto): Promise<Post>`
  - Cáº­p nháº­t post, khÃ´ng cho phÃ©p Ä‘á»•i slug náº¿u Ä‘Ã£ published

- `remove(id: number): Promise<void>`
  - Soft delete: set deletedAt = now() thay vÃ¬ xÃ³a cá»©ng

- `publishToggle(id: number): Promise<Post>`
  - Toggle isPublished, náº¿u publish thÃ¬ set publishedAt = now()

**LÆ°u Ã½**: DÃ¹ng PrismaService Ä‘Ã£ cÃ³, tráº£ vá» dáº¡ng plain object khÃ´ng chá»©a deletedAt.

**Äáº§u ra**: 1 service file vá»›i 6 methods Ä‘áº§y Ä‘á»§.
```

### **Task 2.4: Táº¡o PostsController**
```prompt
Táº¡o `/backend/src/cms/posts.controller.ts` vá»›i endpoints:

- `GET /api/v1/posts?type=&page=&limit=`
  - DÃ¹ng @Query() vá»›i QueryPostsDto
  - Tráº£ vá» format chuáº©n: {statusCode, message, data, meta}

- `GET /api/v1/posts/:slug`
  - Public: khÃ´ng cáº§n auth
  - Chá»‰ tráº£ vá» post cÃ³ isPublished = true hoáº·c user lÃ  admin

- `POST /api/v1/posts`
  - @UseGuards(JwtAuthGuard, PermissionGuard)
  - Permission: 'post.create'
  - Láº¥y userId tá»« @CurrentUser() decorator

- `PUT /api/v1/posts/:id`
  - Permission: 'post.update'
  - KhÃ´ng cho phÃ©p cáº­p nháº­t post Ä‘Ã£ bá»‹ soft delete

- `DELETE /api/v1/posts/:id`
  - Permission: 'post.delete'
  - Soft delete: gá»i postsService.remove()

- `PATCH /api/v1/posts/:id/publish`
  - Permission: 'post.publish'
  - Toggle publish status

**Äáº§u ra**: 1 controller file vá»›i 6 routes Ä‘áº§y Ä‘á»§ auth & permission.
```

---

## **ğŸ“… DAY 3: PHASE 1 - BRANCHES & USERS-ADMIN BACKEND**

### **Task 3.1: Cáº­p nháº­t Prisma schema Branch**
```prompt
Cáº­p nháº­t model Branch trong `/backend/prisma/schema.prisma`:

```prisma
model Branch {
  id          Int       @id @default(autoincrement())
  code        String    @unique
  name        String
  type        String    // FARM, HOMESTAY, CAFE, SHOP
  settings    Json?     // JSONB config
  isActive    Boolean   @default(true) @map("is_active")
  address     String?
  phone       String?
  createdAt   DateTime  @default(now()) @map("created_at")
  updatedAt   DateTime  @updatedAt @map("updated_at")
  deletedAt   DateTime? @map("deleted_at")
  
  users       UserBranch[]
  bookings    Booking[] // (táº¡m thÃªm, sáº½ dÃ¹ng sau)
  
  @@index([type])
  @@index([isActive])
  @@map("branches")
}
```

**YÃªu cáº§u**:
- ThÃªm vÃ o schema hiá»‡n cÃ³
- Cháº¡y migration: `npx prisma migrate dev --name update-branches-table`
- Cáº­p nháº­t seed: táº¡o 3 chi nhÃ¡nh máº«u (FARM, HOMESTAY, CAFE)

**Äáº§u ra**: schema Ä‘Ã£ cáº­p nháº­t + migration file.
```

### **Task 3.2: Táº¡o Branches CRUD**
```prompt
Táº¡o module Branches Ä‘áº§y Ä‘á»§:

**DTOs** (`/backend/src/branches/dtos/`):
- `create-branch.dto.ts`: code, name, type, settings, address, phone
- `update-branch.dto.ts`: Partial cá»§a create
- Validation: @IsString(), @IsEnum(['FARM','HOMESTAY','CAFE','SHOP'])

**Service** (`branches.service.ts`):
- `create()`, `findAll()`, `findOne()`, `update()`, `remove()` (soft delete)
- Kiá»ƒm tra code unique (P2002)

**Controller** (`branches.controller.ts`):
- `GET /api/v1/branches` - list all (cÃ³ thá»ƒ filter isActive)
- `GET /api/v1/branches/:id` - detail
- `POST /api/v1/branches` - Permission: 'branch.create'
- `PUT /api/v1/branches/:id` - Permission: 'branch.update'
- `DELETE /api/v1/branches/:id` - Permission: 'branch.delete', soft delete

**Äáº§u ra**: 3 files + cáº­p nháº­t `branches.module.ts`.
```

### **Task 3.3: Táº¡o Users-Admin Controller**
```prompt
Táº¡o `/backend/src/users-admin/users-admin.controller.ts` (chá»‰ controller, dÃ¹ng UsersService hiá»‡n cÃ³):

- `GET /api/v1/admin/users?page=&limit=&search=`
  - Permission: 'user.view'
  - Search theo email/name
  - Tráº£ vá»: {id, email, name, roles, isLocked, createdAt}

- `GET /api/v1/admin/users/:id`
  - Permission: 'user.view'
  - Tráº£ vá» chi tiáº¿t user (khÃ´ng bao gá»“m password_hash)

- `PUT /api/v1/admin/users/:id/lock`
  - Permission: 'user.lock'
  - Set `lock_until = now() + 15 minutes`
  - Log action vÃ o security_logger

- `PUT /api/v1/admin/users/:id/unlock`
  - Permission: 'user.lock'
  - Set `lock_until = null`, `failed_login_attempts = 0`

- `PUT /api/v1/admin/users/:id/roles`
  - Permission: 'user.update_roles'
  - Body: {roleIds: number[]}
  - Replace all user roles (xÃ³a cÅ©, thÃªm má»›i)

**LÆ°u Ã½**: DÃ¹ng `@Transactional()` náº¿u cáº§n, dÃ¹ng UserService hiá»‡n cÃ³.

**Äáº§u ra**: 1 controller file.
```

### **Task 3.4: Seed permissions má»›i**
```prompt
Cáº­p nháº­t `/backend/prisma/seed.ts` thÃªm permissions:

```typescript
const permissions = [
  // ... permissions cÅ©
  { code: 'post.create', name: 'Create Post', module: 'CMS' },
  { code: 'post.update', name: 'Update Post', module: 'CMS' },
  { code: 'post.delete', name: 'Delete Post', module: 'CMS' },
  { code: 'post.publish', name: 'Publish Post', module: 'CMS' },
  { code: 'branch.create', name: 'Create Branch', module: 'BRANCH' },
  { code: 'branch.update', name: 'Update Branch', module: 'BRANCH' },
  { code: 'branch.delete', name: 'Delete Branch', module: 'BRANCH' },
  { code: 'user.view', name: 'View Users', module: 'USER' },
  { code: 'user.lock', name: 'Lock/Unlock User', module: 'USER' },
  { code: 'user.update_roles', name: 'Update User Roles', module: 'USER' },
];

// GÃ¡n cho role ADMIN vÃ  SUPER_ADMIN
```

**Äáº§u ra**: seed.ts Ä‘Ã£ cáº­p nháº­t, cháº¡y láº¡i seed Ä‘á»ƒ Ã¡p dá»¥ng.
```

---

## **ğŸ“… DAY 4: PHASE 1 - FRONTEND PUBLIC & ADMIN PAGES**

### **Task 4.1: Táº¡o Public Page - About**
```prompt
Táº¡o `/frontend/src/app/(public)/about/page.tsx`:

**YÃªu cáº§u**:
- Static content (hard-code táº¡m, sau nÃ y láº¥y tá»« API posts type=PAGE)
- Layout: Header, Hero section, Story, Team, Values
- DÃ¹ng Tailwind CSS, responsive
- KhÃ´ng cáº§n auth

**Tham kháº£o**: Landing page hiá»‡n táº¡i Ä‘á»ƒ giá»¯ style nháº¥t quÃ¡n.

**Äáº§u ra**: 1 file Next.js page component.
```

### **Task 4.2: Táº¡o Public Page - Blog List**
```prompt
Táº¡o `/frontend/src/app/(public)/blog/page.tsx`:

**YÃªu cáº§u**:
- Fetch posts tá»« API: `GET /api/v1/posts?type=BLOG&isPublished=true&page=1&limit=10`
- Hiá»ƒn thá»‹ danh sÃ¡ch cards: thumbnail, title, excerpt, publishedAt, author
- Pagination: Load more hoáº·c numbered pagination
- Link Ä‘áº¿n detail page: `/blog/[slug]`
- Loading state: Skeleton cards
- Error handling: Hiá»‡n thÃ´ng bÃ¡o náº¿u API fail

**API Client**: Táº¡o `/frontend/src/lib/api/posts.ts` vá»›i hÃ m `getPosts(query)`

**Äáº§u ra**: 1 page component + 1 api client file.
```

### **Task 4.3: Táº¡o Public Page - Blog Detail**
```prompt
Táº¡o `/frontend/src/app/(public)/blog/[slug]/page.tsx`:

**YÃªu cáº§u**:
- Dynamic route vá»›i slug
- Fetch post detail: `GET /api/v1/posts/${slug}`
- Render content JSON (dÃ¹ng tailwind typography hoáº·c custom renderer)
- SEO: Next.js generateMetadata()
- Not found: redirect vá» /blog náº¿u post khÃ´ng tá»“n táº¡i
- Loading: Skeleton

**Tham kháº£o**: CÃ¡ch fetch data trong Next.js App Router.

**Äáº§u ra**: 1 dynamic page component.
```

### **Task 4.4: Táº¡o Public Page - Contact**
```prompt
Táº¡o `/frontend/src/app/(public)/contact/page.tsx`:

**YÃªu cáº§u**:
- Form: name, email, phone, subject, message
- Submit: POST `/api/v1/contact` (chÆ°a cÃ³ API, táº¡m console.log)
- Validation: frontend (Zod hoáº·c Formik + Yup)
- Success message sau submit
- Layout: Form bÃªn trÃ¡i, thÃ´ng tin liÃªn há»‡ bÃªn pháº£i

**API Client**: Táº¡o `/frontend/src/lib/api/contact.ts` vÃ¬ sau nÃ y sáº½ cÃ³ API.

**Äáº§u ra**: 1 page component vá»›i form Ä‘áº§y Ä‘á»§ validation.
```

### **Task 4.5: Táº¡o Admin Page - Users Management**
```prompt
Táº¡o `/frontend/src/app/(admin)/users/page.tsx`:

**YÃªu cáº§u**:
- Protected: Chá»‰ admin/super_admin (dÃ¹ng AuthContext)
- Fetch users: `GET /api/v1/admin/users?page=&limit=&search=`
- Table: id, email, name, roles, status (locked/active), createdAt
- Actions: Lock/Unlock button má»—i row
- Search bar: TÃ¬m theo email/name
- Pagination: Bottom table
- Permission check: áº¨n actions náº¿u khÃ´ng cÃ³ 'user.lock' permission

**API Client**: `/frontend/src/lib/api/users-admin.ts` vá»›i cÃ¡c hÃ m:
- `getUsers(query)`
- `lockUser(id)`
- `unlockUser(id)`

**Äáº§u ra**: 1 protected page + API client.
```

### **Task 4.6: Táº¡o Admin Page - Branches CRUD**
```prompt
Táº¡o `/frontend/src/app/(admin)/branches/page.tsx`:

**YÃªu cáº§u**:
- Protected + Permission: 'branch.view' (list), 'branch.create' (add)
- Table hiá»ƒn thá»‹ branches: code, name, type, isActive, address
- Modal form: Create/Edit branch (fields: code, name, type select, settings JSON, address, phone)
- Actions: Edit (yÃªu cáº§u 'branch.update'), Delete (yÃªu cáº§u 'branch.delete' - soft delete)
- Refresh data sau CRUD

**API Client**: `/frontend/src/lib/api/branches.ts` vá»›i CRUD methods

**Äáº§u ra**: 1 page component vá»›i table + modal form.
```

### **Task 4.7: Táº¡o Admin Page - Posts Management**
```prompt
Táº¡o `/frontend/src/app/(admin)/posts/page.tsx`:

**YÃªu cáº§u**:
- Protected + Permission: 'post.view'
- Table: posts vá»›i columns: title, type, author, isPublished, publishedAt
- Actions:
  - Publish/Unpublish toggle (yÃªu cáº§u 'post.publish')
  - Edit (yÃªu cáº§u 'post.update')
  - Delete (yÃªu cáº§u 'post.delete' - soft delete)
- Create new post: Link Ä‘áº¿n form (cÃ³ thá»ƒ lÃ m sau hoáº·c modal)
- Filter: Theo type (select), isPublished (checkbox)

**API Client**: `/frontend/src/lib/api/posts.ts` (admin methods)

**Äáº§u ra**: 1 admin page component.
```

---

## **ğŸ“… DAY 5: SECURITY & TESTING**

### **Task 5.1: CÃ i Ä‘áº·t vÃ  cáº¥u hÃ¬nh Helmet**
```prompt
Thá»±c hiá»‡n báº£o máº­t vá»›i Helmet:

1. **CÃ i package**: `npm install @nestjs/helmet`

2. **Cáº­p nháº­t `/backend/src/main.ts`**:
   ```typescript
   import helmet from '@nestjs/helmet';
   
   app.use(helmet({
     contentSecurityPolicy: false, // Táº¯t vÃ¬ Next.js streaming
     crossOriginEmbedderPolicy: false,
     crossOriginResourcePolicy: { policy: "cross-origin" },
     referrerPolicy: { policy: "no-referrer" },
   }));
   ```

3. **Kiá»ƒm tra**: Sau khi cÃ i, API váº«n hoáº¡t Ä‘á»™ng, khÃ´ng bá»‹ block CORS.

**Äáº§u ra**: main.ts Ä‘Ã£ cáº­p nháº­t, package.json thÃªm dependency.
```

### **Task 5.2: Rate limit global**
```prompt
ThÃªm rate limit toÃ n cá»¥c cho backend:

**Cáº­p nháº­t `/backend/src/main.ts`**:
```typescript
import { ThrottlerModule } from '@nestjs/throttler';

// Trong imports
ThrottlerModule.forRoot([{
  ttl: 60000,
  limit: 100, // 100 requests per minute per IP
  skipSuccessfulRequests: false,
}]),
```

**Hoáº·c** náº¿u dÃ¹ng Redis rate limit Ä‘Ã£ cÃ³, Ä‘áº£m báº£o:
- `ENABLE_REDIS_RATE_LIMIT=true` trong .env
- Guard Ã¡p dá»¥ng cho táº¥t cáº£ routes (trá»« /auth/login, /auth/register)

**Äáº§u ra**: Config rate limit Ä‘Ã£ Ã¡p dá»¥ng toÃ n app.
```

### **Task 5.3: Táº¡o E2E test Phase 1 Complete**
```prompt
Táº¡o file `/backend/test/phase1-complete.e2e-spec.ts`:

**Test flow**:
1. Register new user â†’ login â†’ get token
2. Create post (with auth) â†’ verify 201
3. Publish post â†’ verify isPublished=true
4. Get post list (public) â†’ verify xuáº¥t hiá»‡n trong list
5. Create branch (admin) â†’ verify 201
6. Lock user â†’ verify lock_until Ä‘Æ°á»£c set
7. Unlock user â†’ verify lock_until=null

**Sá»­ dá»¥ng**:
- `supertest` Ä‘á»ƒ gá»i HTTP
- PrismaService Ä‘á»ƒ kiá»ƒm tra DB trá»±c tiáº¿p
- JWT token láº¥y tá»« login response

**Threshold**: All tests pass, coverage >80% cho cÃ¡c module má»›i.

**Äáº§u ra**: 1 file E2E test vá»›i describe/it blocks rÃµ rÃ ng.
```

### **Task 5.4: Verify checklist**
```prompt
Kiá»ƒm tra hoÃ n thiá»‡n Phase 0-1:

**Cháº¡y lá»‡nh verify**:
```bash
# Backend
cd backend
npm run test:e2e
npm run lint
npm run build

# Frontend
cd frontend
npm run build  # KhÃ´ng cÃ³ TypeScript error
```

**Manual test**:
1. `curl http://localhost:3000/api/v1/about` â†’ return page content
2. `curl http://localhost:3000/api/v1/posts?type=BLOG` â†’ return published posts
3. `curl -X POST http://localhost:3000/api/v1/branches -H "Authorization: Bearer <admin_token>" -d '{"code":"TEST","name":"Test Branch","type":"FARM"}'` â†’ 201 Created

**Checklist**: ÄÃ¡nh dáº¥u cÃ¡c items trong checklist Day 5 cá»§a file "GÃ³i cÃ´ng viá»‡c need to complete.txt"

**Äáº§u ra**: BÃ¡o cÃ¡o ngáº¯n cÃ¡c test passed/failed.
```

---

## **ğŸ¯ TASK Bá»” SUNG**

### **Task 6.1: Táº¡o `docker-compose.dev.yml`**
```prompt
Táº¡o file `/backend/docker-compose.dev.yml`:

```yaml
version: '3.8'
services:
  postgres:
    image: postgres:15-alpine
    environment:
      POSTGRES_DB: laba_platform_dev
      POSTGRES_USER: laba_user
      POSTGRES_PASSWORD: password
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"

  mailhog:
    image: mailhog/mailhog
    ports:
      - "8025:8025" # Web UI
      - "1025:1025" # SMTP

volumes:
  postgres_data:
```

**Äáº§u ra**: 1 file docker-compose Ä‘á»ƒ dev team dá»… setup.
```

### **Task 6.2: CÃ i Ä‘áº·t Swagger**
```prompt
CÃ i Ä‘áº·t Swagger cho API documentation:

1. **CÃ i package**: `npm install @nestjs/swagger swagger-ui-express`

2. **Cáº­p nháº­t `main.ts`**:
   ```typescript
   import { SwaggerModule, DocumentBuilder } from '@nestjs/swagger';
   
   const config = new DocumentBuilder()
     .setTitle('Laba Platform API')
     .setVersion('1.0')
     .addBearerAuth()
     .build();
   const document = SwaggerModule.createDocument(app, config);
   SwaggerModule.setup('api/docs', app, document);
   ```

3. **Decorators**: ThÃªm @ApiTags, @ApiBearerAuth, @ApiResponse vÃ o controllers (cÃ³ thá»ƒ lÃ m sau)

**Äáº§u ra**: Swagger UI cháº¡y táº¡i `http://localhost:3000/api/docs`.
```

---

## **ğŸ“‹ HÆ¯á»šNG DáºªN Sá»¬ Dá»¤NG Vá»šI CLAUDE**

**Workflow**:
1. Copy tá»«ng prompt vÃ o Claude 4.5
2. YÃªu cáº§u Claude generate code **Ä‘áº§y Ä‘á»§** (khÃ´ng summary)
3. Sau má»—i task, **commit ngay** vÃ o git vá»›i message rÃµ rÃ ng
4. Cháº¡y verify command sau tá»«ng nhÃ³m task
5. Náº¿u cÃ³ lá»—i, paste error vÃ o Claude Ä‘á»ƒ fix

**LÆ°u Ã½ quan trá»ng**:
- LuÃ´n nháº¯c Claude **"Viáº¿t code Ä‘áº§y Ä‘á»§, khÃ´ng summary"**
- Náº¿u task liÃªn quan DB, nháº¯c **"Run migration vÃ  seed sau khi update schema"**
- Náº¿u task frontend, nháº¯c **"DÃ¹ng TypeScript, Axios, React Context Ä‘Ã£ cÃ³"**

Báº¡n muá»‘n tÃ´i báº¯t Ä‘áº§u vá»›i **Task 1.1** ngay khÃ´ng?