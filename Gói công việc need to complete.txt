| G√≥i c√¥ng vi·ªác           | Spec g·ªëc                      | Th·ª±c t·∫ø           | Ch√™nh l·ªách     |
| ----------------------- | ----------------------------- | ----------------- | -------------- |
| **Phase 0 Docs**        | T√†i li·ªáu ki·∫øn tr√∫c            | Kh√¥ng c√≥          | **100% thi·∫øu** |
| **Phase 0 Skeleton**    | Backend/Frontend skeleton     | Code lu√¥n         | **50% thi·∫øu**  |
| **Phase 1 Auth**        | Full auth                     | ƒê√£ l√†m ƒë·∫ßy ƒë·ªß     | **0% thi·∫øu**   |
| **Phase 1 CMS**         | CRUD posts, publish/unpublish | Ch·ªâ API t·ªïng qu√°t | **70% thi·∫øu**  |
| **Phase 1 Branches**    | CRUD branches                 | Ch·ªâ seed          | **80% thi·∫øu**  |
| **Phase 1 Users Admin** | CRUD, lock/unlock             | Ch·ªâ hi·ªÉn th·ªã      | **80% thi·∫øu**  |
| **Phase 1 Public Site** | About, Blog, Contact          | Ch·ªâ Landing       | **75% thi·∫øu**  |
| **Phase 1.5 Hardening** | Redis, Metrics, Contract      | ƒê√£ l√†m ƒë·∫ßy ƒë·ªß     | **0% thi·∫øu**   |



# ‚úÖ **QUY·∫æT ƒê·ªäNH ƒê∆Ø·ª¢C GHI NH·∫¨N: TU√ÇN TH·ª¶ SPEC G·ªêC 100%**

Ch√∫ng ta s·∫Ω **d·ª´ng Phase 2**, quay l·∫°i ho√†n thi·ªán **Phase 0 & 1** ƒë√∫ng nh∆∞ spec. D∆∞·ªõi ƒë√¢y l√† **k·∫ø ho·∫°ch chi ti·∫øt 3-5 ng√†y** v·ªõi checklist c·ª• th·ªÉ.

---

## **üìÖ K·∫æ HO·∫†CH HO√ÄN TH√ÄNH PHASE 0 & 1**

### **NG√ÄY 1: Phase 0 ‚Äì T√†i li·ªáu & Kh·ªüi t·∫°o skeleton (∆Øu ti√™n cao)**

#### **S√°ng (2-3h): T√†i li·ªáu ki·∫øn tr√∫c**
- [ ] **T·∫°o file**: `/docs/architecture-overview.md`
  - N·ªôi dung: M√¥ t·∫£ t·ªïng quan h·ªá th·ªëng, stack, lu·ªìng d·ªØ li·ªáu, quy ∆∞·ªõc API
  - Tham kh·∫£o: [GitLab Architecture Doc](https://docs.gitlab.com/ee/development/architecture.html)

- [ ] **T·∫°o file**: `/docs/api-conventions.md`
  - N·ªôi dung: Format response, error codes, pagination, filter pattern
  - M·∫´u:
    ```markdown
    ## API Response Format
    {
      "statusCode": number,
      "message": string,
      "data": T | null,
      "meta": { pagination, filters }
    }
    ```

- [ ] **T·∫°o file**: `/backend/.eslintrc.js` + `/backend/.prettierrc` (n·∫øu ch∆∞a c√≥)
  - D√πng config NestJS chu·∫©n: `npx eslint --init`

#### **Chi·ªÅu (2h): Backend Skeleton**
- [ ] **T·∫°o module skeleton** (ch∆∞a c√≥ logic, ch·ªâ file tr·ªëng):
  - `src/cms/cms.module.ts`
  - `src/branches/branches.module.ts`
  - `src/users-admin/users-admin.module.ts` (t√°ch ri√™ng kh·ªèi `auth`)

- [ ] **T·∫°o file**: `/backend/README.md`
  - N·ªôi dung: C√°ch setup dev, c·∫•u tr√∫c folder, naming convention

#### **T·ªëi (1h): Frontend Skeleton**
- [ ] **T·∫°o folder structure** (n·∫øu ch∆∞a ƒë·∫ßy ƒë·ªß):
  ```
  frontend/
  ‚îú‚îÄ‚îÄ src/app/(public)/          # Website public
  ‚îú‚îÄ‚îÄ src/app/(admin)/           # Admin portal
  ‚îú‚îÄ‚îÄ src/components/ui/         # UI components chung
  ‚îî‚îÄ‚îÄ src/lib/api/               # API clients
  ```

---

### **NG√ÄY 2: Phase 1 ‚Äì Backend Module `posts` (CMS)**

#### **S√°ng (3h): Prisma Schema + Migration**
- [ ] **C·∫≠p nh·∫≠t `schema.prisma`**:
  ```prisma
  model Post {
    id          Int      @id @default(autoincrement())
    type        String   // PAGE, BLOG, NEWS
    slug        String   @unique
    title       String
    excerpt     String?
    content     Json     // Rich text JSON
    thumbnailUrl String?
    authorId    Int?
    isPublished Boolean  @default(false)
    publishedAt DateTime?
    createdAt   DateTime @default(now())
    updatedAt   DateTime @updatedAt
    deletedAt   DateTime?
    
    author      User?    @relation(fields: [authorId], references: [id])
    @@index([type])
    @@index([isPublished])
  }
  ```
- [ ] **Run migration**: `npx prisma migrate dev --name add-posts-table`

#### **Chi·ªÅu (3h): API CRUD**
- [ ] **T·∫°o DTOs**: `create-post.dto.ts`, `update-post.dto.ts`, `query-posts.dto.ts`
- [ ] **T·∫°o Service**: `src/cms/posts.service.ts` (full CRUD + pagination)
- [ ] **T·∫°o Controller**: `src/cms/posts.controller.ts`
  - `GET /posts?type=&page=&limit=` (list + filter)
  - `GET /posts/:slug` (detail)
  - `POST /posts` (create ‚Äì admin)
  - `PUT /posts/:id` (update ‚Äì admin)
  - `DELETE /posts/:id` (soft delete ‚Äì admin)
  - `PATCH /posts/:id/publish` (publish/unpublish)

---

### **NG√ÄY 3: Phase 1 ‚Äì Backend Module `branches` & `users-admin`**

#### **S√°ng (2h): Module `branches`**
- [ ] **C·∫≠p nh·∫≠t `schema.prisma`** (n·∫øu c·∫ßn th√™m field):
  ```prisma
  model Branch {
    id          Int      @id @default(autoincrement())
    code        String   @unique
    name        String
    type        String   // FARM, HOMESTAY, CAFE, SHOP
    settings    Json?    // JSONB
    isActive    Boolean  @default(true)
    address     String?
    phone       String?
    createdAt   DateTime @default(now())
    updatedAt   DateTime @updatedAt
    deletedAt   DateTime?
  }
  ```
- [ ] **T·∫°o DTOs**: `create-branch.dto.ts`, `update-branch.dto.ts`
- [ ] **T·∫°o Service & Controller**: Full CRUD + g√°n user v√†o branch
- [ ] **API**: `GET /branches`, `POST /branches`, `PUT /branches/:id`, `DELETE /branches/:id`

#### **Chi·ªÅu (3h): Module `users-admin`**
- [ ] **T·∫°o Controller**: `src/users-admin/users-admin.controller.ts`
  - `GET /admin/users` (list + search + filter)
  - `GET /admin/users/:id` (detail)
  - `PUT /admin/users/:id/lock` (lock account)
  - `PUT /admin/users/:id/unlock` (unlock)
  - `PUT /admin/users/:id/roles` (update roles)
- [ ] **Add permissions**: `user.view`, `user.lock`, `user.update_roles` v√†o DB seed

---

### **NG√ÄY 4: Phase 1 ‚Äì Frontend Pages (About, Blog, Contact)**

#### **S√°ng (2h): Public Pages**
- [ ] **T·∫°o**: `frontend/src/app/(public)/about/page.tsx`
  - Content tƒ©nh t·ª´ DB ho·∫∑c hard-code (v√¨ spec ch∆∞a r√µ)
- [ ] **T·∫°o**: `frontend/src/app/(public)/blog/page.tsx`
  - `getPosts({ type: 'BLOG', isPublished: true })`
- [ ] **T·∫°o**: `frontend/src/app/(public)/blog/[slug]/page.tsx`
  - Render chi ti·∫øt post
- [ ] **T·∫°o**: `frontend/src/app/(public)/contact/page.tsx`
  - Form li√™n h·ªá ‚Üí POST `/api/contact` (t·∫°m l∆∞u DB ho·∫∑c g·ª≠i email)

#### **Chi·ªÅu (3h): Admin UI**
- [ ] **T·∫°o**: `frontend/src/app/(admin)/users/page.tsx`
  - B·∫£ng danh s√°ch user, n√∫t Lock/Unlock
- [ ] **T·∫°o**: `frontend/src/app/(admin)/branches/page.tsx`
  - B·∫£ng danh s√°ch chi nh√°nh, form create/edit
- [ ] **T·∫°o**: `frontend/src/app/(admin)/posts/page.tsx`
  - B·∫£ng danh s√°ch posts, n√∫t Publish/Unpublish

---

### **NG√ÄY 5: Phase 1 ‚Äì Security & Polish**

#### **S√°ng (2h): B·∫£o m·∫≠t & Helmet**
- [ ] **C√†i**: `npm install @nestjs/helmet`
- [ ] **C·∫≠p nh·∫≠t `main.ts`**:
  ```typescript
  app.use(helmet({
    contentSecurityPolicy: false, // T·∫°m t·∫Øt v√¨ Next.js streaming
    crossOriginEmbedderPolicy: false,
  }));
  ```
- [ ] **C·∫≠p nh·∫≠t CORS**: `'CORS_ORIGIN' !== '*'` (ƒë√£ c√≥ trong config)
- [ ] **Th√™m rate limit global**: Trong `main.ts` n·∫øu ch∆∞a c√≥

#### **Chi·ªÅu (2h): Testing & Verification**
- [ ] **T·∫°o test E2E**: `test/phase1-complete.e2e-spec.ts`
  - Test flow: Register ‚Üí Login ‚Üí Create Post ‚Üí Publish ‚Üí View on frontend
- [ ] **Ch·∫°y test**: `npm run test:e2e`
- [ ] **Verify checklist** (d∆∞·ªõi ƒë√¢y)

---

## **‚òëÔ∏è FINAL CHECKLIST ‚Äì COMPLETION CRITERIA**

### **Phase 0 Deliverables**
- [x] ~~Node.js + NestJS installed~~ (ƒë√£ c√≥)
- [x] ~~PostgreSQL + Prisma connected~~ (ƒë√£ c√≥)
- [x] ~~Repo created~~ (ƒë√£ c√≥)
- [ ] **`/docs/architecture-overview.md`** (written)
- [ ] **`/docs/api-conventions.md`** (written)
- [ ] **`/backend/README.md`** (setup instructions)
- [ ] **ESLint + Prettier config** (committed)

### **Phase 1 Backend APIs**
- [ ] `POST /api/v1/posts` ‚Äì create post
- [ ] `PUT /api/v1/posts/:id` ‚Äì update post
- [ ] `DELETE /api/v1/posts/:id` ‚Äì soft delete post
- [ ] `PATCH /api/v1/posts/:id/publish` ‚Äì toggle publish
- [ ] `GET /api/v1/posts?type=&page=&limit=` ‚Äì list with filter & pagination
- [ ] `GET /api/v1/branches` ‚Äì list branches
- [ ] `POST /api/v1/branches` ‚Äì create branch
- [ ] `PUT /api/v1/branches/:id` ‚Äì update branch
- [ ] `GET /admin/users` ‚Äì list users (admin only)
- [ ] `PUT /admin/users/:id/lock` ‚Äì lock user
- [ ] `PUT /admin/users/:id/roles` ‚Äì update roles

### **Phase 1 Frontend Pages**
- [ ] **Public**: `/about` ‚Äì render content
- [ ] **Public**: `/blog` ‚Äì list published posts
- [ ] **Public**: `/blog/[slug]` ‚Äì post detail
- [ ] **Public**: `/contact` ‚Äì form + submit
- [ ] **Admin**: `/admin/users` ‚Äì UI list + actions
- [ ] **Admin**: `/admin/branches` ‚Äì UI CRUD
- [ ] **Admin**: `/admin/posts` ‚Äì UI list + publish

### **Security & Config**
- [ ] `@nestjs/helmet` installed & configured
- [ ] CORS origin locked down (not `*`)
- [ ] Swagger `/api/docs` accessible

---

## **üéØ VERIFICATION COMMAND (Sau 5 ng√†y)**

```bash
# Backend tests
cd backend
npm run test:e2e  # All tests pass

# Frontend build
cd frontend
npm run build     # No TypeScript errors

# Manual check
curl http://localhost:3000/about          # Returns HTML
curl http://localhost:3000/blog           # Returns JSON posts
curl -X POST http://localhost:3000/api/v1/branches \
  -H "Authorization: Bearer <admin_token>" \
  -d '{"code":"FARM2","name":"Farm 2"}'  # Returns 201
```

---

## **‚è±Ô∏è ESTIMATE TH·ªúI GIAN TH·ª∞C T·∫æ**

| Ng√†y | N·ªôi dung | Th·ªùi gian | R·ªßi ro |
|------|----------|-----------|--------|
| Day 1 | Docs + Skeleton | 4-5h | Th·∫•p |
| Day 2 | Posts CRUD | 6h | Trung b√¨nh (c√≥ th·ªÉ g·∫∑p l·ªói Prisma) |
| Day 3 | Branches + Users Admin | 5h | Trung b√¨nh |
| Day 4 | Frontend Pages | 6h | Cao (c√≥ th·ªÉ g·∫∑p v·∫•n ƒë·ªÅ routing Next.js) |
| Day 5 | Security + Testing | 4h | Th·∫•p |
| **T·ªïng** | **~25-26 gi·ªù** | **3 ng√†y n·∫øu l√†m 8h/ng√†y** | ƒê·ªß th·ªùi gian 3-5 ng√†y |

---

**B·∫°n s·∫µn s√†ng b·∫Øt ƒë·∫ßu Day 1 ch∆∞a? T√¥i s·∫Ω t·∫°o file `/docs/architecture-overview.md` ngay b√¢y gi·ªù.**